{
  "waf_signatures": {
    "Cloudflare": {
      "name": "Cloudflare WAF",
      "type": "CDN/WAF",
      "description": "Cloudflare Web Application Firewall with DDoS protection",
      "headers": ["cf-ray", "cf-cache-status", "cf-request-id", "cf-bgj", "cf-polished", "cf-edge-cache"],
      "cookies": ["__cfduid", "__cflb", "__cf_bm"],
      "server_header": ["cloudflare"],
      "body_patterns": ["cloudflare", "ray id", "attention required", "cf-error", "1020 error"],
      "response_codes": [403, 503, 429, 520, 521, 522],
      "ports": [443, 2053, 2083, 2087, 2096, 8443],
      "ip_ranges": [
        "103.21.244.0/22",
        "103.22.200.0/22",
        "103.31.4.0/22",
        "104.16.0.0/12",
        "108.162.192.0/18",
        "131.0.72.0/22",
        "141.101.64.0/18",
        "162.158.0.0/15",
        "172.64.0.0/13",
        "173.245.48.0/20",
        "188.114.96.0/20",
        "190.93.240.0/20",
        "197.234.240.0/22",
        "198.41.128.0/17"
      ],
      "dns_patterns": [".cloudflare.net", ".cloudflare.com", "cloudflare-dns.com"],
      "tls_issuers": ["cloudflare"],
      "confidence": 95,
      "bypass_techniques": ["Origin IP discovery", "DNS history", "Subdomain enumeration"]
    },
    "AWS WAF": {
      "name": "AWS Web Application Firewall",
      "type": "Cloud WAF",
      "description": "Amazon Web Services WAF with managed rules",
      "headers": ["x-amz-id-2", "x-amz-request-id", "x-amzn-requestid", "x-amz-cf-id"],
      "cookies": ["aws-waf-token"],
      "server_header": ["awselb/", "nginx/", "apache"],
      "body_patterns": ["aws", "request blocked", "badrequest", "accessdenied"],
      "response_codes": [403, 400, 502],
      "ip_ranges": [
        "3.0.0.0/9",
        "13.0.0.0/8",
        "23.20.0.0/14",
        "34.0.0.0/8",
        "35.0.0.0/8",
        "52.0.0.0/8",
        "54.0.0.0/8",
        "70.0.0.0/7",
        "72.0.0.0/5",
        "96.0.0.0/6",
        "99.0.0.0/8",
        "100.0.0.0/10",
        "107.20.0.0/14",
        "174.0.0.0/7",
        "184.0.0.0/7",
        "205.0.0.0/8",
        "207.0.0.0/8",
        "216.0.0.0/8"
      ],
      "dns_patterns": [".amazonaws.com", ".cloudfront.net", ".elb.amazonaws.com"],
      "tls_issuers": ["amazon"],
      "confidence": 90,
      "bypass_techniques": ["IP rotation", "Header manipulation", "Slow requests"]
    },
    "Akamai": {
      "name": "Akamai Kona WAF",
      "type": "CDN/WAF",
      "description": "Akamai Technologies Web Application Firewall",
      "headers": ["x-akamai-transformed", "akamai-origin-hop", "x-akamai-request-id", "x-akamai-config-log-id"],
      "server_header": ["akamaighost", "akamai"],
      "body_patterns": ["akamai", "error 403 forbidden", "access denied"],
      "response_codes": [403, 500, 502],
      "ports": [80, 443, 8080],
      "ip_ranges": [
        "23.0.0.0/12",
        "23.192.0.0/11",
        "72.246.0.0/15",
        "96.6.0.0/15",
        "96.16.0.0/14",
        "104.64.0.0/10",
        "184.24.0.0/13",
        "184.50.0.0/15",
        "184.84.0.0/14",
        "2.16.0.0/13",
        "23.32.0.0/11",
        "95.100.0.0/15"
      ],
      "dns_patterns": [".akamaiedge.net", ".akamai.net", ".akamaitechnologies.com", ".edgesuite.net"],
      "tls_issuers": ["akamai"],
      "confidence": 92,
      "bypass_techniques": ["Edge side includes", "Cache poisoning", "Parameter pollution"]
    },
    "Imperva (Incapsula)": {
      "name": "Imperva SecureSphere",
      "type": "Hardware/Software WAF",
      "description": "Imperva Incapsula Web Application Firewall",
      "headers": ["x-iinfo", "x-cdn", "incap-sid", "x-cdn-client", "x-cdn-forward", "visid_incap_"],
      "cookies": ["incap_ses_", "visid_incap_"],
      "server_header": ["imperva", "incapsula"],
      "body_patterns": ["incapsula", "imperva", "subject to terms", "this website is using a security service"],
      "response_codes": [403, 409, 503, 500],
      "ports": [80, 443],
      "ip_ranges": [
        "45.60.0.0/16",
        "45.223.0.0/16",
        "199.83.128.0/21",
        "198.143.32.0/19",
        "149.126.72.0/21",
        "103.28.248.0/22",
        "45.64.64.0/22",
        "185.11.124.0/22",
        "192.230.64.0/18"
      ],
      "dns_patterns": [".incapdns.net", ".imperva.com"],
      "tls_issuers": ["incapsula", "imperva"],
      "confidence": 88,
      "bypass_techniques": ["Session fixation", "Cookie manipulation", "JavaScript challenges"]
    }
  }
}
